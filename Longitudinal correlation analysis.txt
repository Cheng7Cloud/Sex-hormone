#这里注意一下，为了不想改动代码，把完整文件hormone_brainn1_20221207的文件名改成了hor_male-20221212，AD_outcome_processed_1104改名为V2_ACD_processed_1106
#AD
# 设置工作目录
setwd("D:/激素脑改投_Nature mental health")
# 输出当前工作目录，以确认是否已成功更改
print(getwd())
# 加载所需库
library(dplyr)
# 读取 "V2_ACD_processed_1106" 文件
v2_acd <- read.csv("V2_ACD_processed_1106.csv")
# 读取 "hor_male-20221212" 文件
hor_male <- read.csv("hor_male-20221212.csv")
# 筛选 "V2_ACD_processed_1106" 中 "eid" 列在 "hor_male-20221212" 中的 "ID" 列中的值
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
# 根据 "hor_male-20221212" 中 "ID" 列的顺序对 "V2_ACD_processed_1106" 排序
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
# 将排序和筛选后的数据保存到新的 CSV 文件中
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/AD.csv", row.names = FALSE)

#Dementia
library(data.table)
setwd("D:/激素脑改投_Nature mental health")
print(getwd())
v2_acd <- fread("survival data/dementia_survival_data.csv", quote = "")
hor_male <- read.csv("hor_male-20221212.csv")
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/Dementia.csv", row.names = FALSE)

#PD
library(data.table)
setwd("D:/激素脑改投_Nature mental health")
print(getwd())
v2_acd <- fread("survival data/PD_survival_data.csv", quote = "")
hor_male <- read.csv("hor_male-20221212.csv")
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/PD.csv", row.names = FALSE)

#Stroke
library(data.table)
setwd("D:/激素脑改投_Nature mental health")
print(getwd())
v2_acd <- fread("survival data/stroke_survival_data.csv", quote = "")
hor_male <- read.csv("hor_male-20221212.csv")
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/Stroke.csv", row.names = FALSE)

#migraine
library(data.table)
setwd("D:/激素脑改投_Nature mental health")
print(getwd())
v2_acd <- fread("survival data/migraine_survival_data.csv", quote = "")
hor_male <- read.csv("hor_male-20221212.csv")
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/Migraine.csv", row.names = FALSE)

#Sleep disorder
library(data.table)
setwd("D:/激素脑改投_Nature mental health")
print(getwd())
v2_acd <- fread("survival data/sleepdisorder_survival_data.csv", quote = "")
hor_male <- read.csv("hor_male-20221212.csv")
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/Sleep disorder.csv", row.names = FALSE)

#Anxiety
library(data.table)
setwd("D:/激素脑改投_Nature mental health")
print(getwd())
v2_acd <- fread("survival data/diseaseanxiety_survival_data.csv", quote = "")
hor_male <- read.csv("hor_male-20221212.csv")
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/Anxiety.csv", row.names = FALSE)

#Depression
library(data.table)
setwd("D:/激素脑改投_Nature mental health")
print(getwd())
v2_acd <- fread("survival data/depression_survival_data.csv", quote = "")
hor_male <- read.csv("hor_male-20221212.csv")
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/Depression.csv", row.names = FALSE)

#Bipolar
library(data.table)
setwd("D:/激素脑改投_Nature mental health")
print(getwd())
v2_acd <- fread("survival data/bipolar_survival_data.csv", quote = "")
hor_male <- read.csv("hor_male-20221212.csv")
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/Bipolar.csv", row.names = FALSE)

#Schizophrenia
library(data.table)
setwd("D:/激素脑改投_Nature mental health")
print(getwd())
v2_acd <- fread("survival data/schizophrenia_survival_data.csv", quote = "")
hor_male <- read.csv("hor_male-20221212.csv")
v2_acd_filtered <- v2_acd %>%
  filter(eid %in% hor_male$ID)
v2_acd_sorted <- v2_acd_filtered[order(match(v2_acd_filtered$eid, hor_male$ID)), ]
write.csv(v2_acd_sorted, "D:/激素脑改投_Nature mental health/disease_data/Schizophrenia.csv", row.names = FALSE)

#AD筛选
# 读取CSV文件
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\AD.csv"
data <- read.csv(file_path)
# 保留eid、AD_y和follow_up这三列
selected_data <- data[, c("eid", "AD_y", "follow_up")]
# 将结果输出为CSV文件，覆盖原始文件
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\AD.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\AD.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "AD_y"] <- "AD_status"
colnames(data)[colnames(data) == "follow_up"] <- "AD_days_ins0"
write.csv(data, file_path, row.names = FALSE)

#Dementia筛选
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Dementia.csv"
data <- read.csv(file_path)
selected_data <- data[, c("eid", "status", "disease_days")]
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\Dementia.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Dementia.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "status"] <- "Dementia_status"
colnames(data)[colnames(data) == "disease_days"] <- "Dementia_days_ins0"
write.csv(data, "D:\\激素脑改投_Nature mental health\\disease_data\\Dementia.csv", row.names = FALSE)

#PD筛选
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\PD.csv"
data <- read.csv(file_path)
selected_data <- data[, c("eid", "status", "disease_days")]
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\PD.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\PD.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "status"] <- "PD_status"
colnames(data)[colnames(data) == "disease_days"] <- "PD_days_ins0"
write.csv(data, "D:\\激素脑改投_Nature mental health\\disease_data\\PD.csv", row.names = FALSE)

#Stroke筛选
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Stroke.csv"
data <- read.csv(file_path)
selected_data <- data[, c("eid", "status", "disease_days")]
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\Stroke.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Stroke.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "status"] <- "Stroke_status"
colnames(data)[colnames(data) == "disease_days"] <- "Stroke_days_ins0"
write.csv(data, "D:\\激素脑改投_Nature mental health\\disease_data\\Stroke.csv", row.names = FALSE)

#migraine筛选
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Migraine.csv"
data <- read.csv(file_path)
selected_data <- data[, c("eid", "status", "disease_days")]
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\Migraine.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Migraine.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "status"] <- "Migraine_status"
colnames(data)[colnames(data) == "disease_days"] <- "Migraine_days_ins0"
write.csv(data, "D:\\激素脑改投_Nature mental health\\disease_data\\Migraine.csv", row.names = FALSE)

#Sleep disorder筛选
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Sleep disorder.csv"
data <- read.csv(file_path)
selected_data <- data[, c("eid", "status", "disease_days")]
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\Sleep disorder.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Sleep disorder.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "status"] <- "Sleep disorder_status"
colnames(data)[colnames(data) == "disease_days"] <- "Sleep disorder_days_ins0"
write.csv(data, "D:\\激素脑改投_Nature mental health\\disease_data\\Sleep disorder.csv", row.names = FALSE)

#Anxiety筛选
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Anxiety.csv"
data <- read.csv(file_path)
selected_data <- data[, c("eid", "status", "disease_days")]
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\Anxiety.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Anxiety.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "status"] <- "Anxiety_status"
colnames(data)[colnames(data) == "disease_days"] <- "Anxiety_days_ins0"
write.csv(data, "D:\\激素脑改投_Nature mental health\\disease_data\\Anxiety.csv", row.names = FALSE)

#Depression筛选
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Depression.csv"
data <- read.csv(file_path)
selected_data <- data[, c("eid", "status", "disease_days")]
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\Depression.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Depression.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "status"] <- "Depression_status"
colnames(data)[colnames(data) == "disease_days"] <- "Depression_days_ins0"
write.csv(data, "D:\\激素脑改投_Nature mental health\\disease_data\\Depression.csv", row.names = FALSE)

#Bipolar筛选
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Bipolar.csv"
data <- read.csv(file_path)
selected_data <- data[, c("eid", "status", "disease_days")]
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\Bipolar.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Bipolar.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "status"] <- "Bipolar_status"
colnames(data)[colnames(data) == "disease_days"] <- "Bipolar_days_ins0"
write.csv(data, "D:\\激素脑改投_Nature mental health\\disease_data\\Bipolar.csv", row.names = FALSE)

#Schizophrenia筛选
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Schizophrenia.csv"
data <- read.csv(file_path)
selected_data <- data[, c("eid", "status", "disease_days")]
write.csv(selected_data, "D:\\激素脑改投_Nature mental health\\disease_data\\Schizophrenia.csv", row.names = FALSE)
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Schizophrenia.csv"
data <- read.csv(file_path)
colnames(data)[colnames(data) == "status"] <- "Schizophrenia_status"
colnames(data)[colnames(data) == "disease_days"] <- "Schizophrenia_days_ins0"
write.csv(data, "D:\\激素脑改投_Nature mental health\\disease_data\\Schizophrenia.csv", row.names = FALSE)

# 读取CSV文件
file_path <- "D:\\激素脑改投_Nature mental health\\hor_male-20221212.csv"
data <- read.csv(file_path)

# 指定需要删除的列的列索引范围（11到40列）
columns_to_remove <- 11:40

# 使用负索引删除指定列范围
data <- data[, -columns_to_remove]

# 指定保存的文件路径
save_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\hor_male-20221212.csv"

# 将修改后的数据保存到指定文件路径
write.csv(data, save_path, row.names = FALSE)

#合并
#AD
# 读取 hor_male 文件
hor_male_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\hor_male-20221212.csv"
hor_male_data <- read.csv(hor_male_path)

# 读取 AD 文件
ad_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\AD.csv"
ad_data <- read.csv(ad_path)

# 获取 hor_male 文件中的 ID 列和 AD 文件中的 eid 列
hor_male_id <- hor_male_data$ID
ad_eid <- ad_data$eid

# 找到不在 ad_eid 中的 hor_male_id 的行索引并删除
#rows_to_remove <- which(!hor_male_id %in% ad_eid)
#hor_male_data <- hor_male_data[-rows_to_remove, ]

# 将 hor_male 文件中的 ID 列的列名改为 eid
colnames(hor_male_data)[colnames(hor_male_data) == "ID"] <- "eid"

# 合并两个文件
merged_data <- merge(ad_data, hor_male_data, by = "eid", all.y = TRUE)

# 读取 Dementia 文件
dementia_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Dementia.csv"
dementia_data <- read.csv(dementia_path)
merged_data_eid <- merged_data$eid
dementia_eid <- dementia_data$eid
#rows_to_remove <- which(!merged_data_eid %in% dementia_eid)
#print(rows_to_remove)
#merged_data <- merged_data[-rows_to_remove, ]
#merged_data_eid <- merged_data$eid
#dementia_eid <- dementia_data$eid
#rows_to_remove <- which(!dementia_eid %in% merged_data_eid)
#print(rows_to_remove)
#dementia_data <- dementia_data[-rows_to_remove, ]
merged_data <- merge(dementia_data, merged_data, by = "eid", all.y = TRUE)
# 读取 PD 文件
PD_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\PD.csv"
PD_data <- read.csv(PD_path)
merged_data_eid <- merged_data$eid
PD_eid <- PD_data$eid
#rows_to_remove <- which(!merged_data_eid %in% PD_eid)
#print(rows_to_remove)
#merged_data <- merged_data[-rows_to_remove, ]
#merged_data_eid <- merged_data$eid
#PD_eid <- PD_data$eid
#rows_to_remove <- which(!PD_eid %in% merged_data_eid)
#print(rows_to_remove)
#PD_data <- PD_data[-rows_to_remove, ]
merged_data <- merge(PD_data, merged_data, by = "eid", all.y = TRUE)
head(merged_data)
# 读取 Stroke 文件
Stroke_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Stroke.csv"
Stroke_data <- read.csv(Stroke_path)
merged_data_eid <- merged_data$eid
Stroke_eid <- Stroke_data$eid
#rows_to_remove <- which(!merged_data_eid %in% Stroke_eid)
#print(rows_to_remove)
#merged_data <- merged_data[-rows_to_remove, ]
#merged_data_eid <- merged_data$eid
#Stroke_eid <- Stroke_data$eid
#rows_to_remove <- which(!Stroke_eid %in% merged_data_eid)
#print(rows_to_remove)
#Stroke_data <- Stroke_data[-rows_to_remove, ]
merged_data <- merge(Stroke_data, merged_data, by = "eid", all.y = TRUE)
head(merged_data)
# 读取 Migraine 文件
Migraine_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Migraine.csv"
Migraine_data <- read.csv(Migraine_path)
merged_data_eid <- merged_data$eid
Migraine_eid <- Migraine_data$eid
#rows_to_remove <- which(!merged_data_eid %in% Migraine_eid)
#print(rows_to_remove)
#merged_data <- merged_data[-rows_to_remove, ]
#merged_data_eid <- merged_data$eid
#Migraine_eid <- Migraine_data$eid
#rows_to_remove <- which(!Migraine_eid %in% merged_data_eid)
#print(rows_to_remove)
#Migraine_data <- Migraine_data[-rows_to_remove, ]
merged_data <- merge(Migraine_data, merged_data, by = "eid", all.y = TRUE)
head(merged_data)
# 读取Sleep disorder 文件
Sleep_disorder_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Sleep disorder.csv"
Sleep_disorder_data <- read.csv(Sleep_disorder_path)
merged_data_eid <- merged_data$eid
Sleep_disorder_eid <- Sleep_disorder_data$eid
#rows_to_remove <- which(!merged_data_eid %in% Sleep_disorder_eid)
#print(rows_to_remove)
#merged_data <- merged_data[-rows_to_remove, ]
#merged_data_eid <- merged_data$eid
#Sleep_disorder_eid <- Sleep_disorder_data$eid
#rows_to_remove <- which(!Sleep_disorder_eid %in% merged_data_eid)
#print(rows_to_remove)
#Sleep_disorder_data <- Sleep_disorder_data[-rows_to_remove, ]
merged_data <- merge(Sleep_disorder_data, merged_data, by = "eid", all.y = TRUE)
head(merged_data)
# 读取 Anxiety 文件
Anxiety_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Anxiety.csv"
Anxiety_data <- read.csv(Anxiety_path)
merged_data_eid <- merged_data$eid
Anxiety_eid <- Anxiety_data$eid
#rows_to_remove <- which(!merged_data_eid %in% Anxiety_eid)
#print(rows_to_remove)
#merged_data <- merged_data[-rows_to_remove, ]
#merged_data_eid <- merged_data$eid
#Anxiety_eid <- Anxiety_data$eid
#rows_to_remove <- which(!Anxiety_eid %in% merged_data_eid)
#print(rows_to_remove)
#Anxiety_data <- Anxiety_data[-rows_to_remove, ]
merged_data <- merge(Anxiety_data, merged_data, by = "eid", all.y = TRUE)
head(merged_data)
# 读取 Depression 文件
Depression_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Depression.csv"
Depression_data <- read.csv(Depression_path)
merged_data_eid <- merged_data$eid
Depression_eid <- Depression_data$eid
#rows_to_remove <- which(!merged_data_eid %in% Depression_eid)
#print(rows_to_remove)
#merged_data <- merged_data[-rows_to_remove, ]
#merged_data_eid <- merged_data$eid
#Depression_eid <- Depression_data$eid
#rows_to_remove <- which(!Depression_eid %in% merged_data_eid)
#print(rows_to_remove)
#Depression_data <- Depression_data[-rows_to_remove, ]
merged_data <- merge(Depression_data, merged_data, by = "eid", all.y = TRUE)
head(merged_data)
# 读取 Bipolar 文件
Bipolar_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Bipolar.csv"
Bipolar_data <- read.csv(Bipolar_path)
merged_data_eid <- merged_data$eid
Bipolar_eid <- Bipolar_data$eid
#rows_to_remove <- which(!merged_data_eid %in% Bipolar_eid)
#print(rows_to_remove)
#merged_data <- merged_data[-rows_to_remove, ]
#merged_data_eid <- merged_data$eid
#Bipolar_eid <- Bipolar_data$eid
#rows_to_remove <- which(!Bipolar_eid %in% merged_data_eid)
#print(rows_to_remove)
#Bipolar_data <- Bipolar_data[-rows_to_remove, ]
merged_data <- merge(Bipolar_data, merged_data, by = "eid", all.y = TRUE)
head(merged_data)
# 读取 Schizophrenia 文件
Schizophrenia_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\Schizophrenia.csv"
Schizophrenia_data <- read.csv(Schizophrenia_path)
merged_data_eid <- merged_data$eid
Schizophrenia_eid <- Schizophrenia_data$eid
#rows_to_remove <- which(!merged_data_eid %in% Schizophrenia_eid)
#print(rows_to_remove)
#merged_data <- merged_data[-rows_to_remove, ]
#merged_data_eid <- merged_data$eid
#Schizophrenia_eid <- Schizophrenia_data$eid
#rows_to_remove <- which(!Schizophrenia_eid %in% merged_data_eid)
#print(rows_to_remove)
#Schizophrenia_data <- Schizophrenia_data[-rows_to_remove, ]
merged_data <- merge(Schizophrenia_data, merged_data, by = "eid", all.y = TRUE)
head(merged_data)
save_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\merged_data.csv"
write.csv(merged_data, save_path, row.names = FALSE)

file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\merged_data.csv"
data <- read.csv(file_path, header = TRUE)

# 找到列名为 "X" 的列的索引
x_col_index <- which(names(data) == "X")

# 将 "X" 列移到第一列
data <- data[, c(x_col_index, setdiff(1:ncol(data), x_col_index))]

# 如果需要，你可以保存修改后的数据到新的CSV文件
write.csv(data, file = "D:\\激素脑改投_Nature mental health\\disease_data\\merged_data.csv", row.names = FALSE)

#################################
###删除基线时有结局疾病的数据####
#################################
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\merged_data.csv"
# 读取CSV文件
data <- read.csv(file_path, header = TRUE)
# 定义要检查的列
columns_to_check <- c("Schizophrenia_days_ins0", "Bipolar_days_ins0", "Depression_days_ins0", 
                      "Anxiety_days_ins0", "Sleep.disorder_days_ins0", "Migraine_days_ins0",
                      "Stroke_days_ins0", "PD_days_ins0", "Dementia_days_ins0", "AD_days_ins0")
# 过滤出其中任何指定列值小于0的行
filtered_data <- data %>%
  filter(across(all_of(columns_to_check), ~. >= 0))
# 指定保存文件路径
output_file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\merged_data_nonoutcomedisease.csv"
# 将过滤后的数据保存为新的CSV文件
write.csv(filtered_data, file = output_file_path, row.names = FALSE)

##################################
####删除基线有内分泌疾病的数据####
##################################
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\merged_data_nonoutcomedisease.csv"
# 读取CSV文件
data <- read.csv(file_path, header = TRUE)
# 定义要检查的列
columns_to_check <- c("opioids", "ovarian", "adrenogenital", "testiculardysfunction",
                      "Contraceptive", "HRT", "Pitdisease")
# 过滤出其中任何指定列值为1的行
filtered_data <- data %>%
  filter(across(all_of(columns_to_check), ~. != 1))
# 指定保存文件路径
output_file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\merged_data_nonoutcome_baselinedisease.csv"
# 将过滤后的数据保存为新的CSV文件
write.csv(filtered_data, file = output_file_path, row.names = FALSE)

##################################
####删除性激素有缺失的数据########
##################################
file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\merged_data_nonoutcome_baselinedisease.csv"
# 读取CSV文件
data <- read.csv(file_path, header = TRUE)
# 定义要检查的列
columns_to_check <- c("SHBG", "testo", "free.T", "IGF")
# 过滤出其中任何指定列值为NA的行
filtered_data <- data %>%
  filter(across(all_of(columns_to_check), complete.cases))
# 指定保存文件路径
output_file_path <- "D:\\激素脑改投_Nature mental health\\disease_data\\merged_data_nondisease_nonNA.csv"
# 将过滤后的数据保存为新的CSV文件
write.csv(filtered_data, file = output_file_path, row.names = FALSE)



#分割男女
# 读取数据
data <- read.csv("D:\\激素脑改投_Nature mental health\\disease_data\\merged_data_nondisease_nonNA.csv")

# 删除Sex_F列内容为0的行
data_sex_1 <- data[data$Sex_F != 0,]

# 将处理后的数据写入文件
write.csv(data_sex_1, file = "D:/激素脑改投_Nature mental health/disease_data/data_sex_1.csv", row.names = FALSE)
file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_1.csv"
df <- read.csv(file_path)
# 将"free.T"列的内容都乘以1000
df$free.T <- df$free.T * 1000
# 保存修改后的数据框到同一文件
write.csv(df, file = file_path, row.names = FALSE)

data <- read.csv("D:\\激素脑改投_Nature mental health\\disease_data\\merged_data_nondisease_nonNA.csv")
data_sex_0 <- data[data$Sex_F != 1,]
write.csv(data_sex_0, file = "D:/激素脑改投_Nature mental health/disease_data/data_sex_0.csv", row.names = FALSE)
file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_0.csv"
df <- read.csv(file_path)
df$free.T <- df$free.T * 1000
write.csv(df, file = file_path, row.names = FALSE)

###################
#####跑Cox分析#####
###################
setwd('D:/hor_Cox/')
getwd()=='D:/hor_Cox'
library(data.table)
library(gtsummary)
library(survival)

###############
#Female组的Cox#
###############
#连续变量标准化
hor_female <- as.data.frame(fread("D:/hor_Cox/hor_female.csv"))
hor_female$Oestradiol <- scale(hor_female$Oestradiol)
hor_female$free.T <- scale(hor_female$free.T)
hor_female$IGF <- scale(hor_female$IGF)
hor_female$testo <- scale(hor_female$testo)
hor_female$SHBG <- scale(hor_female$SHBG)
#设置协变量和因变量
hor_female$Age_cat <- as.factor(hor_female$Age_cat)
hor_female$RACE <- as.factor(hor_female$RACE)
hor_female$Town_cat <- as.factor(hor_female$Town_cat)
hor_female$edu_cat <- as.factor(hor_female$edu_cat)
hor_female$ALC <- as.factor(hor_female$ALC)
hor_female$DM <- as.factor(hor_female$DM)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$SMK <- as.factor(hor_female$SMK)
hor_female$diabetes <- as.factor(hor_female$diabetes)
hor_female$Menopausesum <- as.factor(hor_female$Menopausesum)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$Dementia_status <- as.factor(hor_female$Dementia_status)
hor_female$AD_status <- as.factor(hor_female$AD_status)
hor_female$PD_status <- as.factor(hor_female$PD_status)
hor_female$Migraine_status <- as.factor(hor_female$Migraine_status)
hor_female$Stroke_status <- as.factor(hor_female$Stroke_status)
hor_female$Sleep.disorder_status <- as.factor(hor_female$Sleep.disorder_status)
hor_female$Anxiety_status <- as.factor(hor_female$Anxiety_status)
hor_female$Depression_status <- as.factor(hor_female$Depression_status)
hor_female$Bipolar_status <- as.factor(hor_female$Bipolar_status)
hor_female$Schizophrenia_status <- as.factor(hor_female$Schizophrenia_status)

################
#dementia和SHBG#
################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和SHBG
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和SHBG
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和SHBG
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和SHBG
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和SHBG
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和SHBG
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和SHBG
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和SHBG
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和SHBG
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和testo#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和testo
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和testo
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和testo
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和testo
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和testo
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和testo
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和testo
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和testo
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和testo
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和FreeT#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和FreeT
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和FreeT
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和FreeT
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和FreeT
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和FreeT
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和FreeT
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和FreeT
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和FreeT
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和FreeT
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和IGF-1#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和IGF-1
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和IGF-1
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和IGF-1
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和IGF-1
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和IGF-1
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和IGF-1
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和IGF-1
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
p_value_IGF <- summary(res.cox)$coefficients["IGF", "Pr(>|z|)"]
print(p_value_IGF)
str(res.cox)
cox.zph(res.cox)
#Bopolar和IGF-1
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和IGF-1
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


######################
#dementia和oestradiol#
######################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#tbl_regression(res.cox, exponentiate = TRUE)
#AD和oestradiol
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和oestradiol
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和oestradiol
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和oestradiol
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和oestradiol
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和oestradiol
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和oestradiol
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bipolar和oestradiol
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和oestradiol
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)




###############
#Male组的Cox#
###############
#连续变量标准化
hor_male <- as.data.frame(fread("D:/hor_Cox/hor_male.csv"))
hor_male$Oestradiol <- scale(hor_male$Oestradiol)
hor_male$free.T <- scale(hor_male$free.T)
hor_male$IGF <- scale(hor_male$IGF)
hor_male$testo <- scale(hor_male$testo)
hor_male$SHBG <- scale(hor_male$SHBG)
#设置协变量和因变量
hor_male$Age_cat <- as.factor(hor_male$Age_cat)
hor_male$RACE <- as.factor(hor_male$RACE)
hor_male$Town_cat <- as.factor(hor_male$Town_cat)
hor_male$edu_cat <- as.factor(hor_male$edu_cat)
hor_male$ALC <- as.factor(hor_male$ALC)
hor_male$DM <- as.factor(hor_male$DM)
hor_male$HT <- as.factor(hor_male$HT)
hor_male$SMK <- as.factor(hor_male$SMK)
hor_male$diabetes <- as.factor(hor_male$diabetes)
hor_male$Menopausesum <- as.factor(hor_male$Menopausesum)
hor_male$HT <- as.factor(hor_male$HT)
hor_male$Dementia_status <- as.factor(hor_male$Dementia_status)
hor_male$AD_status <- as.factor(hor_male$AD_status)
hor_male$PD_status <- as.factor(hor_male$PD_status)
hor_male$Migraine_status <- as.factor(hor_male$Migraine_status)
hor_male$Stroke_status <- as.factor(hor_male$Stroke_status)
hor_male$Sleep.disorder_status <- as.factor(hor_male$Sleep.disorder_status)
hor_male$Anxiety_status <- as.factor(hor_male$Anxiety_status)
hor_male$Depression_status <- as.factor(hor_male$Depression_status)
hor_male$Bipolar_status <- as.factor(hor_male$Bipolar_status)
hor_male$Schizophrenia_status <- as.factor(hor_male$Schizophrenia_status)


################
#dementia和SHBG#
################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
p_value_SHBG <- summary(res.cox)$coefficients["SHBG", "Pr(>|z|)"]
print(p_value_SHBG)
str(res.cox)
cox.zph(res.cox)
#AD和SHBG
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和SHBG
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和SHBG
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和SHBG
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和SHBG
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和SHBG
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和SHBG
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和SHBG
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和SHBG
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和testo#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和testo
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和testo
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和testo
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和testo
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和testo
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和testo
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和testo
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和testo
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和testo
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和FreeT#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和FreeT
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和FreeT
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和FreeT
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和FreeT
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和FreeT
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和FreeT
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和FreeT
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和FreeT
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和FreeT
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和IGF-1#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和IGF-1
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和IGF-1
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
p_value_IGF <- summary(res.cox)$coefficients["IGF", "Pr(>|z|)"]
print(p_value_IGF)
str(res.cox)
cox.zph(res.cox)
#stroke和IGF-1
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和IGF-1
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和IGF-1
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和IGF-1
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和IGF-1
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和IGF-1
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和IGF-1
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


######################
#dementia和oestradiol#
######################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#tbl_regression(res.cox, exponentiate = TRUE)
#AD和oestradiol
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和oestradiol
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和oestradiol
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和oestradiol
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和oestradiol
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和oestradiol
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和oestradiol
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bipolar和oestradiol
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和oestradiol
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)

#FDR校正
# 假设你有一串p值存储在一个向量中，比如p_values
p_values <- c(4.00E-12,0.0597,0.34377,7.99E-08,0.48981,9.35E-05,1.30E-05,1.66E-05,0.17099,0.013883)
# 使用p.adjust对p值进行FDR校正（Benjamini-Hochberg方法）
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
# 打印原始p值和FDR校正后的p值
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.621991,0.062942,0.294709,0.00135,0.507701,2.88E-06,0.0359,0.3704,0.6034,0.82885)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(9.10E-09,0.000204,0.549087,0.75261,0.775036,0.041473,0.54903,0.37061,0.533427,0.134321)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.217893,0.7064,6.44E-12,0.000724,0.01501,0.41238,0.1811,0.02746,0.587176,0.28387)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.169112,0.1444,0.498764,0.7663,0.419,0.255396,0.015778,0.982471,0.69538,0.4219)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(5.96E-06,0.001287,0.1217,0.005269,0.183383,0.12846,0.386234,0.1097,0.62178,0.15852)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.1045,0.975971,0.31529,0.004987,0.012611,0.08096,0.926088,0.01452,0.61804,0.012283)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.785052,0.247508,0.76695,0.219458,0.010097,0.61367,0.869791,0.0303,0.27551,0.046535)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.196793,0.045484,7.41E-06,0.00448,0.041511,0.14847,0.143179,0.029067,0.14123,0.436486)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.9227,0.83805,0.32,0.13035,0.4924,0.024879,0.76323,0.352922,0.979534,0.44379)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

###############
#Female组的RCS#
###############
#连续变量标准化
library(data.table)
hor_female <- as.data.frame(fread("D:/hor_Cox/hor_female.csv"))
library(rms)
library(ggplot2)
#Dementia_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)

#AD_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)

#PD_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)

#Stroke_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)

#Migraine_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)

#Sleep.disorder_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)

#Anxiety_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)

#Depression_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)

#Bipolar_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)

#Schizophrenia_SHBG
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,x=TRUE, y=TRUE,data=hor_female)
quan <- quantile(hor_female$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,120))
P2
anova(fit)

#Dementia_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0,5), breaks = c(0,1,2,3,4,5))
P2
anova(fit)
#AD_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0,5), breaks = c(0,1,2,3,4,5))
P2
anova(fit)
#PD_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0,5), breaks = c(0,1,2,3,4,5))
P2
anova(fit)
#Stroke_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0,5), breaks = c(0,1,2,3,4,5))
P2
anova(fit)
#Migraine_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0,5), breaks = c(0,1,2,3,4,5))
P2
anova(fit)
#Sleep.disorder_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0,5), breaks = c(0,1,2,3,4,5))
P2
anova(fit)
#Anxiety_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0,5), breaks = c(0,1,2,3,4,5))
P2
anova(fit)
#Depression_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.7,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0.3,4.3), breaks = c(0.5,1,1.5,2,2.5,3,3.5,4))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Bipolar_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0,5), breaks = c(0,1,2,3,4,5))
P2
anova(fit)
#Schizophrenia_testo
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(0,5), breaks = c(0,1,2,3,4,5))
P2
anova(fit)

#Dementia_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#AD_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
#PD_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
#Stroke_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
#Migraine_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
#Sleep.disorder_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
#Anxiety_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Depression_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Bipolar_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Schizophrenia_IGF
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)

#Dementia_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.5)) +scale_x_continuous(limits = c(1,100), breaks = c(5,10,15,20,25,30))
P2
anova(fit)
#AD_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.5)) +scale_x_continuous(limits = c(5,30), breaks = c(5,10,15,20,25,30))
P2
anova(fit)
#PD_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.5)) +scale_x_continuous(limits = c(5,30), breaks = c(5,10,15,20,25,30))
P2
anova(fit)
#Stroke_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.5)) +scale_x_continuous(limits = c(5,30), breaks = c(5,10,15,20,25,30))
P2
anova(fit)
#Migraine_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.5)) +scale_x_continuous(limits = c(5,30), breaks = c(5,10,15,20,25,30))
P2
anova(fit)
#Sleep.disorder_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.5)) +scale_x_continuous(limits = c(5,30), breaks = c(5,10,15,20,25,30))
P2
anova(fit)
#Anxiety_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.5)) +scale_x_continuous(limits = c(5,30), breaks = c(5,10,15,20,25,30))
P2
anova(fit)
#Depression_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.25) , breaks = c(0.75,1.0,1.25)) +scale_x_continuous(limits = c(5,30), breaks = c(5,10,15,20,25,30))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Bipolar_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.5)) +scale_x_continuous(limits = c(5,30), breaks = c(5,10,15,20,25,30))
P2
anova(fit)
#Schizophrenia_FreeT
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.5)) +scale_x_continuous(limits = c(5,30), breaks = c(5,10,15,20,25,30))
P2
anova(fit)

#Dementia_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)
#AD_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)
#PD_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)
#Stroke_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)
#Migraine_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)
#Sleep.disorder_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)
#Anxiety_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)
#Depression_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)
#Bipolar_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)
#Schizophrenia_Oestradiol
dd <- datadist(hor_female)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT+Menopausesum,data=hor_female)
quan <- quantile(hor_female$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(200,350) , breaks = c(200,225,250,275,300,325,350))
P2
anova(fit)

###############
#Male组的RCS#
###############
#连续变量标准化
library(data.table)
hor_male <- as.data.frame(fread("D:/hor_Cox/hor_male.csv"))
library(rms)
library(ggplot2)

#Dementia_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,100))
P2
anova(fit)
#AD_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,100))
P2
anova(fit)
#PD_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,100))
P2
anova(fit)
#Stroke_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,100))
P2
anova(fit)
#Migraine_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,100))
P2
anova(fit)
#Sleep.disorder_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,100))
P2
anova(fit)
#Anxiety_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,100))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Depression_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,70), breaks = c(10,20,30,40,50,60,70))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Bipolar_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,100))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Schizophrenia_SHBG
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(SHBG,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$SHBG, na.rm=TRUE)
dd$limits$SHBG[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkblue")+
  geom_ribbon(data=Predict(update(fit),SHBG,fun=exp,ref.zero = TRUE), aes(SHBG,ymin = lower, ymax = upper),alpha = 0.1,fill="darkblue") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="SHBG (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2) , breaks = c(0.75,1.0,1.25,1.50,1.75,2.00))+scale_x_continuous(limits = c(15,100))
P2
anova(fit)

#Dementia_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,45),  breaks  = c(5,15,25,35,45))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#AD_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,45),  breaks  = c(5,15,25,35,45))
P2
anova(fit)
#PD_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,45),  breaks  = c(5,15,25,35,45))
P2
anova(fit)
#Stroke_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,45),  breaks  = c(5,15,25,35,45))
P2
anova(fit)
#Migraine_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,45),  breaks  = c(5,15,25,35,45))
P2
anova(fit)
#Sleep.disorder_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,45),  breaks  = c(5,15,25,35,45))
P2
anova(fit)
#Anxiety_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.75) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,25),  breaks  = c(5,10,15,20,25))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Depression_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.75) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,25),  breaks  = c(5,10,15,20,25))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Bipolar_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,45),  breaks  = c(5,15,25,35,45))
P2
anova(fit)
#Schizophrenia_testo
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(testo,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$testo, na.rm=TRUE)
dd$limits$testo[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkgreen")+
  geom_ribbon(data=Predict(update(fit),testo,fun=exp,ref.zero = TRUE), aes(testo,ymin = lower, ymax = upper),alpha = 0.1,fill="darkgreen") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Testosterone (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.75,1.0,1.25,1.50,1.75))+scale_x_continuous(limits = c(5,45),  breaks  = c(5,15,25,35,45))
P2
anova(fit)

#Dementia_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#AD_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#PD_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
#Stroke_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Migraine_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
#Sleep.disorder_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
#Anxiety_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,40))
P2
anova(fit)
#Depression_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Bipolar_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)
#Schizophrenia_IGF
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(IGF,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$IGF, na.rm=TRUE)
dd$limits$IGF[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="orange")+
  geom_ribbon(data=Predict(update(fit),IGF,fun=exp,ref.zero = TRUE), aes(IGF,ymin = lower, ymax = upper),alpha = 0.1,fill="orange") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="IGF-1 (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.50) , breaks = c(0.75,1.0,1.25,1.50))+scale_x_continuous(limits = c(10,35))
P2
anova(fit)

#Dementia_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,1.75) , breaks = c(0.50,0.75,1.0,1.25,1.50,1.75)) +scale_x_continuous(limits = c(100,400) , breaks = c(100,200,300,400))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#AD_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.50,0.75,1.0,1.25,1.50,1.75,2.00)) +scale_x_continuous(limits = c(100,600) , breaks = c(100,200,300,400,500,600))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#PD_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.50,0.75,1.0,1.25,1.50,1.75,2.00)) +scale_x_continuous(limits = c(100,600) , breaks = c(100,200,300,400,500,600))
P2
anova(fit)
#Stroke_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.50,0.75,1.0,1.25,1.50,1.75,2.00)) +scale_x_continuous(limits = c(100,600) , breaks = c(100,200,300,400,500,600))
P2
anova(fit)
#Migraine_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.50,0.75,1.0,1.25,1.50,1.75,2.00)) +scale_x_continuous(limits = c(100,600) , breaks = c(100,200,300,400,500,600))
P2
anova(fit)
#Sleep.disorder_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.50,0.75,1.0,1.25,1.50,1.75,2.00)) +scale_x_continuous(limits = c(100,600) , breaks = c(100,200,300,400,500,600))
P2
anova(fit)
#Anxiety_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50)) +scale_x_continuous(limits = c(100,400) , breaks = c(100,200,300,400))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Depression_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.75,1.5) , breaks = c(0.75,1.0,1.25,1.50)) +scale_x_continuous(limits = c(100,400) , breaks = c(100,200,300,400))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)
#Bipolar_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.50,0.75,1.0,1.25,1.50,1.75,2.00)) +scale_x_continuous(limits = c(100,600) , breaks = c(100,200,300,400,500,600))
P2
anova(fit)
#Schizophrenia_free.T
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(free.T,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$free.T, na.rm=TRUE)
dd$limits$free.T[2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="darkred")+
  geom_ribbon(data=Predict(update(fit),free.T,fun=exp,ref.zero = TRUE), aes(free.T,ymin = lower, ymax = upper),alpha = 0.1,fill="darkred") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Free Testosterone (pmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.5,2.0) , breaks = c(0.50,0.75,1.0,1.25,1.50,1.75,2.00)) +scale_x_continuous(limits = c(100,600) , breaks = c(100,200,300,400,500,600))
P2
anova(fit)
out<-anova(fit)
out<-as.data.frame(out)

#Dementia_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Dementia_days_ins0,Dementia_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)
#AD_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(AD_days_ins0,AD_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)
#PD_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(PD_days_ins0,PD_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)
#Stroke_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Stroke_days_ins0,Stroke_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)
#Migraine_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Migraine_days_ins0,Migraine_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)
#Sleep.disorder_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Sleep.disorder_days_ins0,Sleep.disorder_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)
#Anxiety_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Anxiety_days_ins0,Anxiety_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)
#Depression_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Depression_days_ins0,Depression_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)
#Bipolar_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Bipolar_days_ins0,Bipolar_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)
#Schizophrenia_Oestradiol
dd <- datadist(hor_male)
options(datadist='dd')
fit<- cph(Surv(Schizophrenia_days_ins0,Schizophrenia_status)~ rcs(Oestradiol,5)+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT,data=hor_male)
quan <- quantile(hor_male$Oestradiol , na.rm=TRUE)
dd$limits$Oestradiol [2] <- quan[[3]]
P2<-ggplot()+geom_line(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,yhat),linetype="solid",size=1.5,alpha = 0.7,colour="purple")+
  geom_ribbon(data=Predict(update(fit),Oestradiol ,fun=exp,ref.zero = TRUE), aes(Oestradiol ,ymin = lower, ymax = upper),alpha = 0.1,fill="purple") 
P2<-P2+theme_classic(base_size = 18)+geom_hline(yintercept=1, linetype=2,size=1.2)+geom_vline(xintercept=c(quan[[2]],quan[[4]]),size=1.2, linetype="dotted", color="gray")+labs(x="Oestradiol (nmol/L) ", y="Hazard ratios (95%CI)")+scale_y_continuous(limits = c(0.25,3.0), breaks = c(0.25,0.50,0.75,1.0,1.25,1.50,1.75,2.0,2.25,2.50,2.75,3.0)) +scale_x_continuous(limits = c(150,300) , breaks = c(150,175,200,225,250,275,300))
P2
anova(fit)


############
####FDR#####
############
p_values <- c(0.4678,0.2898,0.6951,0.7949,0.786,0.1066,0.0296,0.0007,0.2681,0.6765)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.0395,0.9416,0.5575,0.0225,0.5805,0.8965,0.0016,3.16E-07,0.0208,0.6106)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.006,0.8691,0.8525,0.0523,0.9768,0.3128,2.04E-09,9.77E-12,0.1719,0.4511)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(1.30E-13,6.25E-02,0.4299,4.08E-07,0.7498,0.632,0.0012,1.05E-10,0.8499,0.364)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.1465,0.2205,0.7139,0.9932,0.5505,0.0265,0.9117,0.2025,0.5034,0.6631)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.6406,0.0893,0.2149,0.3009,0.006,0.09,0.3329,0.0421,0.4826,0.3367)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.5237,0.4285,0.3746,0.0434,0.5445,0.6875,0.0568,0.0015,0.9994,0.2533)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.0368,0.0208,0.1099,0.3547,0.5823,0.7814,0.1151,0.0046,0.656,0.959)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.0035,0.1058,0.8707,0.0026,0.3736,0.5609,0.0213,0.0374,0.1519,0.9342)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.2823,0.0626,0.2355,0.4329,0.7421,0.6733,0.4558,0.6735,0.1598,0.5148)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

#提取人群的随访年限限制在5年
#Female
# 安装和加载必要的库
#install.packages("tidyverse")
library(tidyverse)
# 读取原始数据
file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_1.csv"
data <- read.csv(file_path)
# 选择需要保留的列
columns_to_keep <- c("Schizophrenia_days_ins0", "Bipolar_days_ins0", "Depression_days_ins0",
                     "Anxiety_days_ins0", "Sleep.disorder_days_ins0", "Migraine_days_ins0",
                     "Stroke_days_ins0", "PD_days_ins0", "Dementia_days_ins0", "AD_days_ins0")
# 根据条件筛选行
filtered_data <- data %>%
  filter(rowSums(select(., columns_to_keep) > 1825) == length(columns_to_keep))
# 保存结果到新的文件
output_file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_female_5years.csv"
write.csv(filtered_data, file = output_file_path, row.names = FALSE)

#Male
file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_0.csv"
data <- read.csv(file_path)
columns_to_keep <- c("Schizophrenia_days_ins0", "Bipolar_days_ins0", "Depression_days_ins0",
                     "Anxiety_days_ins0", "Sleep.disorder_days_ins0", "Migraine_days_ins0",
                     "Stroke_days_ins0", "PD_days_ins0", "Dementia_days_ins0", "AD_days_ins0")
filtered_data <- data %>%
  filter(rowSums(select(., columns_to_keep) > 1825) == length(columns_to_keep))
output_file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_male_5years.csv"
write.csv(filtered_data, file = output_file_path, row.names = FALSE)

#提取绝经期妇女
file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_1.csv"
data <- read.csv(file_path)
filtered_data <- data %>%
  filter(Menopausesum == 1)
output_file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_menopause_1.csv"
write.csv(filtered_data, file = output_file_path, row.names = FALSE)

#提取>=65
#Female
file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_1.csv"
data <- read.csv(file_path)
filtered_data <- data %>%
  filter(Age >= 65)
output_file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_female_age_upper65.csv"
write.csv(filtered_data, file = output_file_path, row.names = FALSE)

#Male
file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_0.csv"
data <- read.csv(file_path)
filtered_data <- data %>%
  filter(Age >= 65)
output_file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_male_age_upper65.csv"
write.csv(filtered_data, file = output_file_path, row.names = FALSE)

#提取<65
#Female
file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_1.csv"
data <- read.csv(file_path)
filtered_data <- data %>%
  filter(Age < 65)
output_file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_female_age_lower65.csv"
write.csv(filtered_data, file = output_file_path, row.names = FALSE)

#Male
file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_0.csv"
data <- read.csv(file_path)
filtered_data <- data %>%
  filter(Age < 65)
output_file_path <- "D:/激素脑改投_Nature mental health/disease_data/data_sex_male_age_lower65.csv"
write.csv(filtered_data, file = output_file_path, row.names = FALSE)

##########################
######随访年限Cox#########
##########################
setwd('D:/激素脑改投_Nature mental health/disease_data')
getwd()
library(data.table)
library(gtsummary)
library(survival)

###############
#Female组的Cox#
###############
#连续变量标准化
hor_female <- as.data.frame(fread("D:/激素脑改投_Nature mental health/disease_data/data_sex_female_5years.csv"))
hor_female$Oestradiol <- scale(hor_female$Oestradiol)
hor_female$free.T <- scale(hor_female$free.T)
hor_female$IGF <- scale(hor_female$IGF)
hor_female$testo <- scale(hor_female$testo)
hor_female$SHBG <- scale(hor_female$SHBG)
#设置协变量和因变量
hor_female$Age_cat <- as.factor(hor_female$Age_cat)
hor_female$RACE <- as.factor(hor_female$RACE)
hor_female$Town_cat <- as.factor(hor_female$Town_cat)
hor_female$edu_cat <- as.factor(hor_female$edu_cat)
hor_female$ALC <- as.factor(hor_female$ALC)
hor_female$DM <- as.factor(hor_female$DM)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$SMK <- as.factor(hor_female$SMK)
hor_female$diabetes <- as.factor(hor_female$diabetes)
hor_female$Menopausesum <- as.factor(hor_female$Menopausesum)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$Dementia_status <- as.factor(hor_female$Dementia_status)
hor_female$AD_status <- as.factor(hor_female$AD_status)
hor_female$PD_status <- as.factor(hor_female$PD_status)
hor_female$Migraine_status <- as.factor(hor_female$Migraine_status)
hor_female$Stroke_status <- as.factor(hor_female$Stroke_status)
hor_female$Sleep.disorder_status <- as.factor(hor_female$Sleep.disorder_status)
hor_female$Anxiety_status <- as.factor(hor_female$Anxiety_status)
hor_female$Depression_status <- as.factor(hor_female$Depression_status)
hor_female$Bipolar_status <- as.factor(hor_female$Bipolar_status)
hor_female$Schizophrenia_status <- as.factor(hor_female$Schizophrenia_status)

################
#dementia和SHBG#
################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和SHBG
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和SHBG
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和SHBG
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和SHBG
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和SHBG
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和SHBG
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和SHBG
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和SHBG
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和SHBG
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和testo#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和testo
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和testo
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和testo
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和testo
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和testo
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和testo
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和testo
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和testo
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和testo
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和FreeT#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和FreeT
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和FreeT
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和FreeT
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和FreeT
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和FreeT
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和FreeT
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和FreeT
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和FreeT
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和FreeT
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和IGF-1#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和IGF-1
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和IGF-1
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和IGF-1
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和IGF-1
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和IGF-1
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和IGF-1
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和IGF-1
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
p_value_IGF <- summary(res.cox)$coefficients["IGF", "Pr(>|z|)"]
print(p_value_IGF)
str(res.cox)
cox.zph(res.cox)
#Bopolar和IGF-1
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和IGF-1
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


######################
#dementia和oestradiol#
######################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#tbl_regression(res.cox, exponentiate = TRUE)
#AD和oestradiol
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和oestradiol
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和oestradiol
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和oestradiol
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和oestradiol
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和oestradiol
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和oestradiol
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bipolar和oestradiol
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和oestradiol
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)




###############
#Male组的Cox#
###############
#连续变量标准化
hor_male <- as.data.frame(fread("D:/激素脑改投_Nature mental health/disease_data/data_sex_male_5years.csv"))
hor_male$Oestradiol <- scale(hor_male$Oestradiol)
hor_male$free.T <- scale(hor_male$free.T)
hor_male$IGF <- scale(hor_male$IGF)
hor_male$testo <- scale(hor_male$testo)
hor_male$SHBG <- scale(hor_male$SHBG)
#设置协变量和因变量
hor_male$Age_cat <- as.factor(hor_male$Age_cat)
hor_male$RACE <- as.factor(hor_male$RACE)
hor_male$Town_cat <- as.factor(hor_male$Town_cat)
hor_male$edu_cat <- as.factor(hor_male$edu_cat)
hor_male$ALC <- as.factor(hor_male$ALC)
hor_male$DM <- as.factor(hor_male$DM)
hor_male$HT <- as.factor(hor_male$HT)
hor_male$SMK <- as.factor(hor_male$SMK)
hor_male$diabetes <- as.factor(hor_male$diabetes)
hor_male$Menopausesum <- as.factor(hor_male$Menopausesum)
hor_male$HT <- as.factor(hor_male$HT)
hor_male$Dementia_status <- as.factor(hor_male$Dementia_status)
hor_male$AD_status <- as.factor(hor_male$AD_status)
hor_male$PD_status <- as.factor(hor_male$PD_status)
hor_male$Migraine_status <- as.factor(hor_male$Migraine_status)
hor_male$Stroke_status <- as.factor(hor_male$Stroke_status)
hor_male$Sleep.disorder_status <- as.factor(hor_male$Sleep.disorder_status)
hor_male$Anxiety_status <- as.factor(hor_male$Anxiety_status)
hor_male$Depression_status <- as.factor(hor_male$Depression_status)
hor_male$Bipolar_status <- as.factor(hor_male$Bipolar_status)
hor_male$Schizophrenia_status <- as.factor(hor_male$Schizophrenia_status)


################
#dementia和SHBG#
################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
p_value_SHBG <- summary(res.cox)$coefficients["SHBG", "Pr(>|z|)"]
print(p_value_SHBG)
str(res.cox)
cox.zph(res.cox)
#AD和SHBG
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和SHBG
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和SHBG
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和SHBG
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和SHBG
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和SHBG
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和SHBG
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和SHBG
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和SHBG
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和testo#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和testo
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和testo
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和testo
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和testo
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和testo
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和testo
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和testo
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和testo
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和testo
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和FreeT#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和FreeT
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和FreeT
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和FreeT
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和FreeT
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和FreeT
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和FreeT
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和FreeT
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和FreeT
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和FreeT
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和IGF-1#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和IGF-1
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和IGF-1
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
p_value_IGF <- summary(res.cox)$coefficients["IGF", "Pr(>|z|)"]
print(p_value_IGF)
str(res.cox)
cox.zph(res.cox)
#stroke和IGF-1
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和IGF-1
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和IGF-1
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和IGF-1
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和IGF-1
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和IGF-1
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和IGF-1
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


######################
#dementia和oestradiol#
######################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#tbl_regression(res.cox, exponentiate = TRUE)
#AD和oestradiol
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和oestradiol
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和oestradiol
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和oestradiol
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和oestradiol
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和oestradiol
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和oestradiol
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bipolar和oestradiol
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和oestradiol
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)

############
####FDR#####
############
p_values <- c(8.76E-09,0.091299,0.44,0.000175,0.769,0.008504,9.15E-05,4.16E-06,0.9367,0.01557)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.701331,0.150442,0.52343,0.02,0.4505,0.000139,0.004474,0.162568,0.6554,0.76008)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(3.22E-06,0.00184,0.63254,0.5263,0.5182,0.074867,0.06334,0.48951,0.3188,0.18846)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.371318,0.89808,4.52E-09,0.0776,0.1126,0.158389,0.370347,0.021882,0.5922,0.05523)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.05689,0.0278,0.4326,0.981369,0.1167,0.599692,0.006054,0.82125,0.5407,0.2559)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(4.11E-05,0.003654,0.2942,0.006109,0.94822,0.001194,0.325208,0.188249,0.86121,0.86268)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.297586,0.705402,0.34361,0.16161,0.02298,0.033715,0.802286,0.06336,0.35686,0.13855)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.968618,0.133633,0.71299,0.897066,0.06183,0.771661,0.512802,0.067147,0.22016,0.14098)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.721077,0.206307,1.39E-06,0.017161,0.93123,0.269044,0.036087,0.42983,0.18442,0.55032)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.61105,0.73379,0.313923,0.24599,0.65201,0.12359,0.916009,0.26332,0.41596,0.4514)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)


##########################
######<65岁的Cox#########
##########################
setwd('D:/激素脑改投_Nature mental health/disease_data')
getwd()
library(data.table)
library(gtsummary)
library(survival)

###############
#Female组的Cox#
###############
#连续变量标准化
hor_female <- as.data.frame(fread("D:/激素脑改投_Nature mental health/disease_data/data_sex_female_age_lower65.csv"))
hor_female$Oestradiol <- scale(hor_female$Oestradiol)
hor_female$free.T <- scale(hor_female$free.T)
hor_female$IGF <- scale(hor_female$IGF)
hor_female$testo <- scale(hor_female$testo)
hor_female$SHBG <- scale(hor_female$SHBG)
#设置协变量和因变量
hor_female$Age_cat <- as.factor(hor_female$Age_cat)
hor_female$RACE <- as.factor(hor_female$RACE)
hor_female$Town_cat <- as.factor(hor_female$Town_cat)
hor_female$edu_cat <- as.factor(hor_female$edu_cat)
hor_female$ALC <- as.factor(hor_female$ALC)
hor_female$DM <- as.factor(hor_female$DM)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$SMK <- as.factor(hor_female$SMK)
hor_female$diabetes <- as.factor(hor_female$diabetes)
hor_female$Menopausesum <- as.factor(hor_female$Menopausesum)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$Dementia_status <- as.factor(hor_female$Dementia_status)
hor_female$AD_status <- as.factor(hor_female$AD_status)
hor_female$PD_status <- as.factor(hor_female$PD_status)
hor_female$Migraine_status <- as.factor(hor_female$Migraine_status)
hor_female$Stroke_status <- as.factor(hor_female$Stroke_status)
hor_female$Sleep.disorder_status <- as.factor(hor_female$Sleep.disorder_status)
hor_female$Anxiety_status <- as.factor(hor_female$Anxiety_status)
hor_female$Depression_status <- as.factor(hor_female$Depression_status)
hor_female$Bipolar_status <- as.factor(hor_female$Bipolar_status)
hor_female$Schizophrenia_status <- as.factor(hor_female$Schizophrenia_status)

################
#dementia和SHBG#
################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和SHBG
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和SHBG
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和SHBG
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和SHBG
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和SHBG
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和SHBG
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和SHBG
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和SHBG
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和SHBG
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和testo#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和testo
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和testo
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和testo
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和testo
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和testo
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和testo
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和testo
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和testo
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和testo
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和FreeT#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和FreeT
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和FreeT
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和FreeT
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和FreeT
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和FreeT
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和FreeT
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和FreeT
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和FreeT
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和FreeT
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和IGF-1#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和IGF-1
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和IGF-1
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和IGF-1
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和IGF-1
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和IGF-1
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和IGF-1
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和IGF-1
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
p_value_IGF <- summary(res.cox)$coefficients["IGF", "Pr(>|z|)"]
print(p_value_IGF)
str(res.cox)
cox.zph(res.cox)
#Bopolar和IGF-1
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和IGF-1
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


######################
#dementia和oestradiol#
######################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#tbl_regression(res.cox, exponentiate = TRUE)
#AD和oestradiol
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和oestradiol
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和oestradiol
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和oestradiol
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和oestradiol
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和oestradiol
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和oestradiol
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bipolar和oestradiol
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和oestradiol
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)




###############
#Male组的Cox#
###############
#连续变量标准化
hor_male <- as.data.frame(fread("D:/激素脑改投_Nature mental health/disease_data/data_sex_male_age_lower65.csv"))
hor_male$Oestradiol <- scale(hor_male$Oestradiol)
hor_male$free.T <- scale(hor_male$free.T)
hor_male$IGF <- scale(hor_male$IGF)
hor_male$testo <- scale(hor_male$testo)
hor_male$SHBG <- scale(hor_male$SHBG)
#设置协变量和因变量
hor_male$Age_cat <- as.factor(hor_male$Age_cat)
hor_male$RACE <- as.factor(hor_male$RACE)
hor_male$Town_cat <- as.factor(hor_male$Town_cat)
hor_male$edu_cat <- as.factor(hor_male$edu_cat)
hor_male$ALC <- as.factor(hor_male$ALC)
hor_male$DM <- as.factor(hor_male$DM)
hor_male$HT <- as.factor(hor_male$HT)
hor_male$SMK <- as.factor(hor_male$SMK)
hor_male$diabetes <- as.factor(hor_male$diabetes)
hor_male$Menopausesum <- as.factor(hor_male$Menopausesum)
hor_male$HT <- as.factor(hor_male$HT)
hor_male$Dementia_status <- as.factor(hor_male$Dementia_status)
hor_male$AD_status <- as.factor(hor_male$AD_status)
hor_male$PD_status <- as.factor(hor_male$PD_status)
hor_male$Migraine_status <- as.factor(hor_male$Migraine_status)
hor_male$Stroke_status <- as.factor(hor_male$Stroke_status)
hor_male$Sleep.disorder_status <- as.factor(hor_male$Sleep.disorder_status)
hor_male$Anxiety_status <- as.factor(hor_male$Anxiety_status)
hor_male$Depression_status <- as.factor(hor_male$Depression_status)
hor_male$Bipolar_status <- as.factor(hor_male$Bipolar_status)
hor_male$Schizophrenia_status <- as.factor(hor_male$Schizophrenia_status)


################
#dementia和SHBG#
################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
p_value_SHBG <- summary(res.cox)$coefficients["SHBG", "Pr(>|z|)"]
print(p_value_SHBG)
str(res.cox)
cox.zph(res.cox)
#AD和SHBG
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和SHBG
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和SHBG
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和SHBG
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和SHBG
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和SHBG
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和SHBG
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和SHBG
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和SHBG
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和testo#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和testo
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和testo
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和testo
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和testo
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和testo
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和testo
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和testo
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和testo
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和testo
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和FreeT#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和FreeT
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和FreeT
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和FreeT
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和FreeT
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和FreeT
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和FreeT
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和FreeT
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和FreeT
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和FreeT
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和IGF-1#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和IGF-1
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和IGF-1
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
p_value_IGF <- summary(res.cox)$coefficients["IGF", "Pr(>|z|)"]
print(p_value_IGF)
str(res.cox)
cox.zph(res.cox)
#stroke和IGF-1
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和IGF-1
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和IGF-1
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和IGF-1
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和IGF-1
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和IGF-1
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和IGF-1
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


######################
#dementia和oestradiol#
######################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#tbl_regression(res.cox, exponentiate = TRUE)
#AD和oestradiol
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和oestradiol
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和oestradiol
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和oestradiol
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和oestradiol
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和oestradiol
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和oestradiol
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bipolar和oestradiol
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和oestradiol
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


############
####FDR#####
############
p_values <- c(5.82E-13,0.297609,0.95682,3.03E-06,0.587032,0.002277,0.000758,0.005343,0.42232,0.02282)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.5924,0.02677,0.75076,0.0213,0.65947,7.07E-06,0.056,0.473212,0.9104,0.741)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(1.34E-08,0.000955,0.8178,0.998,0.92904,0.015602,0.33204,0.901404,0.37096,0.3347)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(3.13E-06,0.389647,1.19E-06,0.000294,0.0202,0.114874,0.2661,0.009511,0.78375,0.7947)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.844295,0.6775,0.98743,0.2743,0.3529,0.6086,0.0346,0.598765,0.070155,0.4281)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.00963,0.573518,0.83936,0.500091,0.370425,0.201119,0.674468,0.507612,0.68166,0.709541)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.039604,0.863593,0.5992,0.004153,0.023089,0.476138,0.342267,0.308427,0.67225,0.027851)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.316565,0.590853,0.54761,0.018175,0.033494,0.852096,0.232971,0.60239,0.2576,0.057627)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.08946,0.00336,0.000308,0.019204,0.005347,0.323244,0.178051,0.005373,0.22022,0.602457)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.65216,0.47459,0.330946,0.09785,0.4555,0.026011,0.85401,0.395289,0.965531,0.43991)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)




##########################
######>65岁的Cox#########
##########################
setwd('D:/激素脑改投_Nature mental health/disease_data')
getwd()
library(data.table)
library(gtsummary)
library(survival)

###############
#Female组的Cox#
###############
#连续变量标准化
hor_female <- as.data.frame(fread("D:/激素脑改投_Nature mental health/disease_data/data_sex_female_age_upper65.csv"))
hor_female$Oestradiol <- scale(hor_female$Oestradiol)
hor_female$free.T <- scale(hor_female$free.T)
hor_female$IGF <- scale(hor_female$IGF)
hor_female$testo <- scale(hor_female$testo)
hor_female$SHBG <- scale(hor_female$SHBG)
#设置协变量和因变量
hor_female$Age_cat <- as.factor(hor_female$Age_cat)
hor_female$RACE <- as.factor(hor_female$RACE)
hor_female$Town_cat <- as.factor(hor_female$Town_cat)
hor_female$edu_cat <- as.factor(hor_female$edu_cat)
hor_female$ALC <- as.factor(hor_female$ALC)
hor_female$DM <- as.factor(hor_female$DM)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$SMK <- as.factor(hor_female$SMK)
hor_female$diabetes <- as.factor(hor_female$diabetes)
hor_female$Menopausesum <- as.factor(hor_female$Menopausesum)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$Dementia_status <- as.factor(hor_female$Dementia_status)
hor_female$AD_status <- as.factor(hor_female$AD_status)
hor_female$PD_status <- as.factor(hor_female$PD_status)
hor_female$Migraine_status <- as.factor(hor_female$Migraine_status)
hor_female$Stroke_status <- as.factor(hor_female$Stroke_status)
hor_female$Sleep.disorder_status <- as.factor(hor_female$Sleep.disorder_status)
hor_female$Anxiety_status <- as.factor(hor_female$Anxiety_status)
hor_female$Depression_status <- as.factor(hor_female$Depression_status)
hor_female$Bipolar_status <- as.factor(hor_female$Bipolar_status)
hor_female$Schizophrenia_status <- as.factor(hor_female$Schizophrenia_status)

################
#dementia和SHBG#
################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和SHBG
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和SHBG
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和SHBG
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和SHBG
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和SHBG
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和SHBG
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和SHBG
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和SHBG
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和SHBG
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和testo#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和testo
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和testo
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和testo
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和testo
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和testo
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和testo
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和testo
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和testo
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和testo
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和FreeT#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和FreeT
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和FreeT
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和FreeT
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和FreeT
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和FreeT
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和FreeT
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和FreeT
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和FreeT
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和FreeT
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和IGF-1#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和IGF-1
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和IGF-1
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和IGF-1
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和IGF-1
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和IGF-1
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和IGF-1
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和IGF-1
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
p_value_IGF <- summary(res.cox)$coefficients["IGF", "Pr(>|z|)"]
print(p_value_IGF)
str(res.cox)
cox.zph(res.cox)
#Bopolar和IGF-1
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和IGF-1
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


######################
#dementia和oestradiol#
######################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#tbl_regression(res.cox, exponentiate = TRUE)
#AD和oestradiol
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和oestradiol
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和oestradiol
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和oestradiol
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和oestradiol
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和oestradiol
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和oestradiol
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bipolar和oestradiol
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和oestradiol
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)




###############
#Male组的Cox#
###############
#连续变量标准化
hor_male <- as.data.frame(fread("D:/激素脑改投_Nature mental health/disease_data/data_sex_male_age_upper65.csv"))
hor_male$Oestradiol <- scale(hor_male$Oestradiol)
hor_male$free.T <- scale(hor_male$free.T)
hor_male$IGF <- scale(hor_male$IGF)
hor_male$testo <- scale(hor_male$testo)
hor_male$SHBG <- scale(hor_male$SHBG)
#设置协变量和因变量
hor_male$Age_cat <- as.factor(hor_male$Age_cat)
hor_male$RACE <- as.factor(hor_male$RACE)
hor_male$Town_cat <- as.factor(hor_male$Town_cat)
hor_male$edu_cat <- as.factor(hor_male$edu_cat)
hor_male$ALC <- as.factor(hor_male$ALC)
hor_male$DM <- as.factor(hor_male$DM)
hor_male$HT <- as.factor(hor_male$HT)
hor_male$SMK <- as.factor(hor_male$SMK)
hor_male$diabetes <- as.factor(hor_male$diabetes)
hor_male$Menopausesum <- as.factor(hor_male$Menopausesum)
hor_male$HT <- as.factor(hor_male$HT)
hor_male$Dementia_status <- as.factor(hor_male$Dementia_status)
hor_male$AD_status <- as.factor(hor_male$AD_status)
hor_male$PD_status <- as.factor(hor_male$PD_status)
hor_male$Migraine_status <- as.factor(hor_male$Migraine_status)
hor_male$Stroke_status <- as.factor(hor_male$Stroke_status)
hor_male$Sleep.disorder_status <- as.factor(hor_male$Sleep.disorder_status)
hor_male$Anxiety_status <- as.factor(hor_male$Anxiety_status)
hor_male$Depression_status <- as.factor(hor_male$Depression_status)
hor_male$Bipolar_status <- as.factor(hor_male$Bipolar_status)
hor_male$Schizophrenia_status <- as.factor(hor_male$Schizophrenia_status)


################
#dementia和SHBG#
################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
p_value_SHBG <- summary(res.cox)$coefficients["SHBG", "Pr(>|z|)"]
print(p_value_SHBG)
str(res.cox)
cox.zph(res.cox)
#AD和SHBG
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和SHBG
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和SHBG
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和SHBG
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和SHBG
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和SHBG
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和SHBG
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和SHBG
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和SHBG
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和testo#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和testo
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和testo
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和testo
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和testo
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和testo
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和testo
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和testo
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和testo
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和testo
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和FreeT#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和FreeT
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和FreeT
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和FreeT
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和FreeT
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和FreeT
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和FreeT
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和FreeT
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和FreeT
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和FreeT
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和IGF-1#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和IGF-1
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和IGF-1
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
p_value_IGF <- summary(res.cox)$coefficients["IGF", "Pr(>|z|)"]
print(p_value_IGF)
str(res.cox)
cox.zph(res.cox)
#stroke和IGF-1
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和IGF-1
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和IGF-1
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和IGF-1
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和IGF-1
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和IGF-1
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和IGF-1
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


######################
#dementia和oestradiol#
######################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#tbl_regression(res.cox, exponentiate = TRUE)
#AD和oestradiol
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和oestradiol
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和oestradiol
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和oestradiol
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和oestradiol
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和oestradiol
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和oestradiol
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bipolar和oestradiol
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和oestradiol
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_male)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


############
####FDR#####
############
p_values <- c(0.003,0.124494,0.25611,0.01102,0.5556,0.01236,0.0106,0.000913,0.17551,0.3512)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.75339,0.488471,0.08653,0.04654,0.4567,0.105682,0.5386,0.8519,0.14322,0.8052)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.0083,0.034496,0.25139,0.69702,0.28874,0.74713,0.4307,0.03591,0.57216,0.1728)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.01729,0.264591,7.66E-07,0.43805,0.44575,0.16212,0.5225,0.77536,0.53164,0.0257)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.12397,0.055553,0.31216,0.3864,0.948,0.000208,0.2681,0.31694,0.6178,0.7115)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.000339,0.000235,0.00992,0.00226,0.4233,0.498308,0.063091,0.138975,0.9372,0.17295)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.61246,0.894457,0.3737,0.44008,0.2024,0.01423,0.023829,6.45E-05,0.6925,0.22547)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.756472,0.302712,0.8976,0.5399,0.1048,0.105915,0.007993,1.45E-05,0.7917,0.29337)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.932326,0.852732,0.0079,0.1159,0.1976,0.262133,0.567694,0.433745,0.4123,0.73444)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.3488,0.194,0.8804,0.4543,0.4,0.6108,0.613,0.2498)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)



##########################
######绝经期女性的Cox#####
##########################
setwd('D:/激素脑改投_Nature mental health/disease_data')
getwd()
library(data.table)
library(gtsummary)
library(survival)

###############
#Female组的Cox#
###############
#连续变量标准化
hor_female <- as.data.frame(fread("D:/激素脑改投_Nature mental health/disease_data/data_sex_menopause_1.csv"))
hor_female$Oestradiol <- scale(hor_female$Oestradiol)
hor_female$free.T <- scale(hor_female$free.T)
hor_female$IGF <- scale(hor_female$IGF)
hor_female$testo <- scale(hor_female$testo)
hor_female$SHBG <- scale(hor_female$SHBG)
#设置协变量和因变量
hor_female$Age_cat <- as.factor(hor_female$Age_cat)
hor_female$RACE <- as.factor(hor_female$RACE)
hor_female$Town_cat <- as.factor(hor_female$Town_cat)
hor_female$edu_cat <- as.factor(hor_female$edu_cat)
hor_female$ALC <- as.factor(hor_female$ALC)
hor_female$DM <- as.factor(hor_female$DM)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$SMK <- as.factor(hor_female$SMK)
hor_female$diabetes <- as.factor(hor_female$diabetes)
hor_female$Menopausesum <- as.factor(hor_female$Menopausesum)
hor_female$HT <- as.factor(hor_female$HT)
hor_female$Dementia_status <- as.factor(hor_female$Dementia_status)
hor_female$AD_status <- as.factor(hor_female$AD_status)
hor_female$PD_status <- as.factor(hor_female$PD_status)
hor_female$Migraine_status <- as.factor(hor_female$Migraine_status)
hor_female$Stroke_status <- as.factor(hor_female$Stroke_status)
hor_female$Sleep.disorder_status <- as.factor(hor_female$Sleep.disorder_status)
hor_female$Anxiety_status <- as.factor(hor_female$Anxiety_status)
hor_female$Depression_status <- as.factor(hor_female$Depression_status)
hor_female$Bipolar_status <- as.factor(hor_female$Bipolar_status)
hor_female$Schizophrenia_status <- as.factor(hor_female$Schizophrenia_status)

################
#dementia和SHBG#
################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和SHBG
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和SHBG
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和SHBG
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和SHBG
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和SHBG
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和SHBG
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和SHBG
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和SHBG
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和SHBG
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~SHBG+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和testo#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和testo
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和testo
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和testo
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和testo
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和testo
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和testo
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和testo
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和testo
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和testo
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~testo+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和FreeT#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和FreeT
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和FreeT
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和FreeT
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和FreeT
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和FreeT
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和FreeT
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和FreeT
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bopolar和FreeT
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和FreeT
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~free.T+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


#################
#dementia和IGF-1#
#################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#AD和IGF-1
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和IGF-1
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和IGF-1
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和IGF-1
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和IGF-1
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和IGF-1
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和IGF-1
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
p_value_IGF <- summary(res.cox)$coefficients["IGF", "Pr(>|z|)"]
print(p_value_IGF)
str(res.cox)
cox.zph(res.cox)
#Bopolar和IGF-1
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和IGF-1
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~IGF+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)


######################
#dementia和oestradiol#
######################
res.cox <- coxph(Surv(Dementia_days_ins0, Dementia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#tbl_regression(res.cox, exponentiate = TRUE)
#AD和oestradiol
res.cox <- coxph(Surv(AD_days_ins0, AD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#PD和oestradiol
res.cox <- coxph(Surv(PD_days_ins0, PD_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#stroke和oestradiol
res.cox <- coxph(Surv(Stroke_days_ins0, Stroke_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#migraine和oestradiol
res.cox <- coxph(Surv(Migraine_days_ins0, Migraine_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#sleep disorder和oestradiol
res.cox <- coxph(Surv(Sleep.disorder_days_ins0, Sleep.disorder_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#anxiety disorder和oestradiol
res.cox <- coxph(Surv(Anxiety_days_ins0, Anxiety_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#depression和oestradiol
res.cox <- coxph(Surv(Depression_days_ins0, Depression_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#Bipolar和oestradiol
res.cox <- coxph(Surv(Bipolar_days_ins0, Bipolar_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)
#SCZ和oestradiol
res.cox <- coxph(Surv(Schizophrenia_days_ins0, Schizophrenia_status==1)~Oestradiol+Age+RACE+Town_cat+edu_cat+BMI+SMK+ALC+DM+HT, data=hor_female)
summary(res.cox)
str(res.cox)
cox.zph(res.cox)

############
####FDR#####
############
p_values <- c(6.40E-06,0.000696,0.0947,0.020275,0.23383,0.288,0.353466,0.003768,0.96494,0.12217)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.155227,0.978428,0.2249,0.017229,0.01662,0.1376,0.558932,0.002286,0.85485,0.09559)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.896102,0.23758,0.6429,0.344046,0.00683,0.6929,0.754266,0.001001,0.66396,0.12927)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.078559,0.0293,1.07E-05,0.010815,0.04618,0.3519,0.497306,0.042007,0.1674,0.45194)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)

p_values <- c(0.78747,0.4677,0.54529,0.9644,0.83106,0.3527,0.475323,0.923822,0.3279,0.636)
fdr_corrected_p_values <- p.adjust(p_values, method = "BH")
data.frame(Original_p_value = p_values, FDR_corrected_p_value = fdr_corrected_p_values)



#################################
##########基线特征###############
#################################
#install.packages("tableone")
library(tableone)
library(data.table)
file_path <- "D:/激素脑改投_Nature mental health/disease_data/merged_data_nondisease_nonNA.csv"
data <- fread(file_path)
myVars <- c('Age','RACE','Town_cat','edu_cat','BMI','ALC','SMK','HT','diabetes','Menopausesum','Albumin','SHBG','testo','free.T','IGF','Oestradiol')
catVars <- c('RACE','edu_cat', 'Town_cat','ALC','SMK','HT','diabetes','Menopausesum')
tab1 <- CreateTableOne(vars = myVars, strata = 'Sex_F', data = data, factorVars = catVars)
tab1Mat <- print(tab1, sexact = "extent", quote = FALSE, noSpaces = TRUE, printToggle = FALSE)
write.csv(tab1Mat, file = "D:/激素脑改投_Nature mental health/disease_data/Table1.csv")

myVars <- c('AD_status','AD_days_ins0','Dementia_status','Dementia_days_ins0','PD_status','PD_days_ins0','Stroke_status','Stroke_days_ins0','Migraine_status','Migraine_days_ins0','Sleep.disorder_status','Sleep.disorder_days_ins0','Anxiety_status','Anxiety_days_ins0','Depression_status','Depression_days_ins0','Bipolar_status','Bipolar_days_ins0','Schizophrenia_status','Schizophrenia_days_ins0')
catVars <- c('AD_status','Dementia_status','PD_status','Stroke_status','Migraine_status','Sleep.disorder_status','Anxiety_status','Depression_status','Bipolar_status','Schizophrenia_status')
tab1 <- CreateTableOne(vars = myVars, strata = 'Sex_F', data = data, factorVars = catVars)
tab1Mat <- print(tab1, sexact = "extent", quote = FALSE, noSpaces = TRUE, printToggle = FALSE)
write.csv(tab1Mat, file = "D:/激素脑改投_Nature mental health/disease_data/Table2.csv")